define("views/ProfileView",["jquery","backbone","mustache","fitness","customCodeClient"],function(e,t,n,r,i){var s=t.View.extend({initialize:function(){this.render()},events:{"click #deauthorize":"deauthorizeFitbit","click #delete_user":"deleteAccount"},render:function(){var t=e("#profile_template"),i={};r.isLoggedIn()&&(i=r.user.toJSON());var s=n.to_html(t.html(),i),o=e("#header_template");return this.$el.empty(),this.$el.append(o.html()).append(s),this.$el.trigger("create"),this},deauthorizeFitbit:function(){e.mobile.loading("show"),i.updateUserWithParams(r.user,{accesstoken:null},function(t,n){e.mobile.loading("hide"),t?router.navigate("auth",!0):r.showMessage("Failed to update user:\n"+n)})},deleteAccount:function(){e.mobile.loading("show"),r.deleteUser(function(t,n,i){e.mobile.loading("hide");if(t)r.showMessage("Account deleted"),router.navigate("login",!0);else{var s="Failed to delete account "+i||"";r.showMessage(s)}})}});return s});